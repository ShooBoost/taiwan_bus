(function(e){function t(t){for(var o,n,c=t[0],s=t[1],u=t[2],l=0,p=[];l<c.length;l++)n=c[l],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&p.push(a[n][0]),a[n]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);f&&f(t);while(p.length)p.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],o=!0,n=1;n<r.length;n++){var c=r[n];0!==a[c]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},n={app:0},a={app:0},i=[];function c(e){return s.p+"js/"+({RouteDetail:"RouteDetail",about:"about"}[e]||e)+"."+{RouteDetail:"7cbf3e71",about:"61334288"}[e]+".js"}function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r={RouteDetail:1,about:1};n[e]?t.push(n[e]):0!==n[e]&&r[e]&&t.push(n[e]=new Promise((function(t,r){for(var o="css/"+({RouteDetail:"RouteDetail",about:"about"}[e]||e)+"."+{RouteDetail:"8d7ae6a8",about:"f8d18ebf"}[e]+".css",a=s.p+o,i=document.getElementsByTagName("link"),c=0;c<i.length;c++){var u=i[c],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===o||l===a))return t()}var p=document.getElementsByTagName("style");for(c=0;c<p.length;c++){u=p[c],l=u.getAttribute("data-href");if(l===o||l===a)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var o=t&&t.target&&t.target.src||a,i=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");i.code="CSS_CHUNK_LOAD_FAILED",i.request=o,delete n[e],f.parentNode.removeChild(f),r(i)},f.href=a;var h=document.getElementsByTagName("head")[0];h.appendChild(f)})).then((function(){n[e]=0})));var o=a[e];if(0!==o)if(o)t.push(o[2]);else{var i=new Promise((function(t,r){o=a[e]=[t,r]}));t.push(o[2]=i);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=c(e);var p=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(f);var r=a[e];if(0!==r){if(r){var o=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;p.message="Loading chunk "+e+" failed.\n("+o+": "+n+")",p.name="ChunkLoadError",p.type=o,p.request=n,r[1](p)}a[e]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var p=0;p<u.length;p++)t(u[p]);var f=l;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0e3f":function(e,t,r){},"129c":function(e,t,r){},"4f2b":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("6cc5");var o=r("7a23"),n={class:"flex flex-direction-column h100 pos-relative"},a={id:"nav",class:"w40-md w30-lg bg-color-white display-none display-block-md pos-absolute z-index99999 border-bottom-grey520"},i={class:"flex color-white jc-space-around ai-center"},c={class:"w100 text-center"},s=Object(o["h"])("directions_bus_filled"),u={class:"w100 text-center"},l={class:"w100 text-center"},p={class:"footer bg-color-white border-box pos-relative display-none-md border-top-grey520"},f={class:"flex h100 color-white jc-space-around ai-center"},h={class:"w100 text-center"},d=Object(o["h"])("directions_bus_filled"),b={class:"w100 text-center"},m={class:"w100 text-center"};function v(e,t,r,v,O,g){var w=Object(o["z"])("router-link"),y=Object(o["z"])("router-view");return Object(o["s"])(),Object(o["e"])("div",n,[Object(o["f"])("header",a,[Object(o["f"])("ul",i,[Object(o["f"])("li",c,[Object(o["i"])(w,{to:"/",class:Object(o["o"])(["border-box w100 p12 fz30 bg-white-color-primary",{"material-icons-round":O.showHome,"material-icons-outlined":!O.showHome}])},{default:Object(o["F"])((function(){return[s]})),_:1},8,["class"])]),Object(o["f"])("li",u,[Object(o["i"])(w,{to:"?routes=favorite",class:"material-icons-outlined border-box w100 p12 fz30 bg-white-color-primary"},{default:Object(o["F"])((function(){return[Object(o["h"])(Object(o["B"])(O.favoriteBorderOrFill),1)]})),_:1})]),Object(o["f"])("li",l,[Object(o["f"])("span",{onClick:t[0]||(t[0]=function(){return g.shareUrl&&g.shareUrl.apply(g,arguments)}),class:"material-icons-outlined border-box w100 p12 fz30 cursor-pointer bg-white-color-primary"}," link ")])])]),Object(o["i"])(y,{class:"w100 flex-grow-1 overflow-scroll"}),Object(o["f"])("footer",p,[Object(o["f"])("ul",f,[Object(o["f"])("li",h,[Object(o["i"])(w,{to:"/",class:Object(o["o"])(["border-box w100 p12 fz32 bg-white-color-primary",{"material-icons-round":O.showHome,"material-icons-outlined":!O.showHome}])},{default:Object(o["F"])((function(){return[d]})),_:1},8,["class"])]),Object(o["f"])("li",b,[Object(o["i"])(w,{to:"?routes=favorite",class:"material-icons-outlined border-box w100 p12 fz32 bg-white-color-primary"},{default:Object(o["F"])((function(){return[Object(o["h"])(Object(o["B"])(O.favoriteBorderOrFill),1)]})),_:1})]),Object(o["f"])("li",m,[Object(o["f"])("span",{onClick:t[1]||(t[1]=function(){return g.shareUrl&&g.shareUrl.apply(g,arguments)}),class:"material-icons-outlined border-box w100 p12 fz32 cursor-pointer bg-white-color-primary"}," ios_share ")])])])])}var O=r("1da1"),g=(r("96cf"),{data:function(){return{showHome:"favorite"!==this.$route.query.routes,favoriteBorderOrFill:"favorite"===this.$route.query.routes?"favorite":"favorite_border"}},watch:{showHome:function(){this.favoriteBorderOrFill=this.showHome?"favorite_border":"favorite"},"$route.query":{handler:function(e){this.showHome="favorite"!==e.routes},deep:!0}},methods:{shareUrl:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:navigator.share?navigator.share({title:"台灣公車查詢",text:"網頁連結:",url:e.$route.fullPath}).then((function(){console.log("成功！")})).catch((function(e){console.log("發生錯誤",e)})):(navigator.clipboard.writeText(window.location.href),alert("複製成功"));case 1:case"end":return t.stop()}}),t)})))()}},created:function(){}}),w=(r("ac32"),r("6b0d")),y=r.n(w);const j=y()(g,[["render",v]]);var R=j,x=(r("d3b7"),r("3ca3"),r("ddb0"),r("6c02")),S=(r("b64b"),r("25f0"),r("fb6a"),{class:"flex-md w100 pos-relative border-box"}),N={id:"infoPanel",class:"w100 w40-md w30-lg h90 h100-md pos-absolute pos-relative-md b0 z-index9999 bg-color-white flex flex-direction-column border-rounded-top-24 border-rounded-none-md pt68-md border-box"},T={class:"px32"},k={key:0,class:"text-center pt12"},D={class:"w100 py12 px22 border-box fz20"},C={class:"w100 gap10 flex jc-space-around mb10"},I={class:"w100 gap10 flex jc-space-around mb10"},B={class:"w100 gap10 flex jc-space-around mb10"},A={class:"w100 gap10 flex jc-space-around"},P={key:1,class:"overflow-scroll flex-grow-1"},E={class:"w100 w60-md w70-lg h100"};function F(e,t,r,n,a,i){var c=Object(o["z"])("RouteSearchPanel"),s=Object(o["z"])("StopsListPanel"),u=Object(o["z"])("Map");return Object(o["s"])(),Object(o["e"])("div",S,[Object(o["f"])("section",N,[Object(o["f"])("div",{onTouchstart:t[0]||(t[0]=Object(o["H"])((function(){return i.setOriginalClientY&&i.setOriginalClientY.apply(i,arguments)}),["prevent","self"])),onTouchmove:t[1]||(t[1]=Object(o["H"])((function(){return i.changeTargetHeight&&i.changeTargetHeight.apply(i,arguments)}),["prevent","self"])),onTouchend:t[2]||(t[2]=Object(o["H"])((function(e){return a.touchInfoPanel=!1}),["prevent","self"])),onMousedown:t[3]||(t[3]=Object(o["H"])((function(){return i.setOriginalClientY&&i.setOriginalClientY.apply(i,arguments)}),["prevent","self"])),onMousemove:t[4]||(t[4]=Object(o["H"])((function(){return i.changeTargetHeight&&i.changeTargetHeight.apply(i,arguments)}),["prevent","self"])),onMouseup:t[5]||(t[5]=Object(o["H"])((function(e){return a.touchInfoPanel=!1}),["prevent"])),class:"py12 text-center material-icons-round fw-bold cursor-pointer display-none-md"}," horizontal_rule ",32),0===Object.keys(a.stopsOfTheRoute).length?(Object(o["s"])(),Object(o["e"])("div",{key:0,class:Object(o["o"])(["flex flex-direction-column overflow-scroll flex-grow-1",{"jc-center":a.showAlartOfNoFavoriteRoute}])},[Object(o["f"])("div",T,[Object(o["G"])(Object(o["f"])("input",{id:"inputOfSearchRoute",class:"w100 border-box mb20 bg-color-grey300 border-none p12 border-rounded-10-md","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.routeName=e}),placeholder:"🔍"},null,512),[[o["D"],a.routeName]])]),a.showAlartOfNoFavoriteRoute?(Object(o["s"])(),Object(o["e"])("p",k,Object(o["B"])(a.showAlartOfNoFavoriteRoute),1)):Object(o["d"])("",!0),Object(o["i"])(c,{routesByKeywords:a.routesByKeywords,onSetRouteCityAndNameForGetStops:i.setRouteCityAndNameForGetStops,class:"overflow-scroll flex-grow-1"},null,8,["routesByKeywords","onSetRouteCityAndNameForGetStops"]),Object(o["f"])("div",D,[Object(o["f"])("div",C,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-red color-white fw-bold cursor-pointer",onClick:t[7]||(t[7]=function(e){return a.routeName=a.routeName.toString()+"紅"})}," 紅 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-blue color-white fw-bold cursor-pointer",onClick:t[8]||(t[8]=function(e){return a.routeName=a.routeName.toString()+"藍"})}," 藍 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[9]||(t[9]=function(e){return a.routeName=a.routeName.toString()+"1"})}," 1 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[10]||(t[10]=function(e){return a.routeName=a.routeName.toString()+"2"})}," 2 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[11]||(t[11]=function(e){return a.routeName=a.routeName.toString()+"3"})}," 3 ")]),Object(o["f"])("div",I,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-green color-white fw-bold cursor-pointer",onClick:t[12]||(t[12]=function(e){return a.routeName=a.routeName.toString()+"綠"})}," 綠 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-brown color-white fw-bold cursor-pointer",onClick:t[13]||(t[13]=function(e){return a.routeName=a.routeName.toString()+"棕"})}," 棕 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[14]||(t[14]=function(e){return a.routeName=a.routeName.toString()+"4"})}," 4 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[15]||(t[15]=function(e){return a.routeName=a.routeName.toString()+"5"})}," 5 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[16]||(t[16]=function(e){return a.routeName=a.routeName.toString()+"6"})}," 6 ")]),Object(o["f"])("div",B,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-orange color-white fw-bold cursor-pointer",onClick:t[17]||(t[17]=function(e){return a.routeName=a.routeName.toString()+"橘"})}," 橘 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-yellow color-white fw-bold cursor-pointer",onClick:t[18]||(t[18]=function(e){return a.routeName=a.routeName.toString()+"黃"})}," 黃 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[19]||(t[19]=function(e){return a.routeName=a.routeName.toString()+"7"})}," 7 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[20]||(t[20]=function(e){return a.routeName=a.routeName.toString()+"8"})}," 8 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[21]||(t[21]=function(e){return a.routeName=a.routeName.toString()+"9"})}," 9 ")]),Object(o["f"])("div",A,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey600 color-white fw-bold cursor-pointer",onClick:t[22]||(t[22]=function(e){return a.routeName=a.routeName.toString()+"F"})}," F "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey600 color-white fw-bold cursor-pointer",onClick:t[23]||(t[23]=function(e){return a.routeName=a.routeName.toString()+"小"})}," 小 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-black color-white cursor-pointer",onClick:t[24]||(t[24]=function(e){return i.focusInput("inputOfSearchRoute")})}," 其他 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[25]||(t[25]=function(e){return a.routeName=a.routeName.toString()+"0"})}," 0 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[26]||(t[26]=function(e){return a.routeName=a.routeName.toString().slice(0,-1)})}," 清除 ")])])],2)):(Object(o["s"])(),Object(o["e"])("div",P,[Object(o["i"])(s,{class:"h100",allDirectionStopsOfTheRoute:a.allDirectionStopsOfTheRoute,prePage:a.nowPage,onSetRouteCityAndNameForGetStops:i.setRouteCityAndNameForGetStops,onChangeDirection:i.changeDirectionForMap,onChangeRoutesToAll:i.changeRoutesToFavoritesOrAll,onRenewFavoriteList:i.renewFavoriteList,onRenewPopMarker:i.renewPopMarker,onResetNowDirection:t[27]||(t[27]=function(e){return a.nowDirection=0})},null,8,["allDirectionStopsOfTheRoute","prePage","onSetRouteCityAndNameForGetStops","onChangeDirection","onChangeRoutesToAll","onRenewFavoriteList","onRenewPopMarker"])]))]),Object(o["f"])("section",E,[Object(o["i"])(u,{class:"w100 h100",mapId:"homeMap",mapCenter:a.mapCenter,stops:a.stops,routeGEOJSON:a.routeGEOJSON,popMarker:a.popMarker},null,8,["mapCenter","stops","routeGEOJSON","popMarker"])])])}r("7db0"),r("4d63"),r("c607"),r("ac1f"),r("2c3e"),r("159b"),r("00b4"),r("5319");var M=r("e33f"),H={class:""},L=["onClick"],Z={class:""},$={key:0,class:"fz20 fw-bold mb4"},U={class:"color-grey"},G={key:0},_={class:"text-center"},z={class:"color-grey"};function q(e,t,r,n,a,i){var c=Object(o["z"])("FavoriteBtn");return Object(o["s"])(),Object(o["e"])("ul",H,[(Object(o["s"])(!0),Object(o["e"])(o["a"],null,Object(o["y"])(r.routesByKeywords,(function(e,t){return Object(o["s"])(),Object(o["e"])("li",{key:t,class:"px32 cursor-pointer hover-bg-grey"},[Object(o["f"])("div",{onClick:function(t){return i.intervalRenewStops(e.City,e.RouteName.Zh_tw,e.RouteUID,e.DepartureStopNameZh,e.DestinationStopNameZh,e.CityName,e.savedInFavorite)},class:"flex jc-space-between border-bottom border-color-grey py12"},[Object(o["f"])("div",Z,[e.RouteName?(Object(o["s"])(),Object(o["e"])("h6",$,Object(o["B"])(e.RouteName.Zh_tw),1)):Object(o["d"])("",!0),Object(o["f"])("p",U,[e.DepartureStopNameZh?(Object(o["s"])(),Object(o["e"])("span",G,Object(o["B"])(e.DepartureStopNameZh)+" -",1)):Object(o["d"])("",!0),Object(o["h"])(" "+Object(o["B"])(e.DestinationStopNameZh),1)])]),Object(o["f"])("div",_,[Object(o["i"])(c,{route:e},null,8,["route"]),Object(o["f"])("p",z,Object(o["B"])(e.CityName.slice(0,2)),1)])],8,L)])})),128))])}var J={key:0,class:"material-icons mb6 color-secondary"},Y={key:1,class:"material-icons mb6 hover-color-sencodary"};function K(e,t,r,n,a,i){return Object(o["s"])(),Object(o["e"])("div",{onClick:t[0]||(t[0]=Object(o["H"])((function(e){return i.saveToFavorite(!r.route.savedInFavorite,r.route)}),["stop"])),class:"cursor-pointer"},[r.route.savedInFavorite?(Object(o["s"])(),Object(o["e"])("span",J," favorite ")):(Object(o["s"])(),Object(o["e"])("span",Y," favorite_border "))])}r("a434"),r("e9c4");var V={props:["route"],emit:["saveToFavorite"],methods:{saveToFavorite:function(e,t){var r=localStorage.getItem("favoriteRouteList"),o=r?JSON.parse(r):[];t.savedInFavorite=!!e,this.$emit("saveToFavorite",e),e?o.push({City:t.City,CityName:t.CityName,RouteName:{Zh_tw:t.RouteName.Zh_tw},RouteUID:t.RouteUID,DepartureStopNameZh:t.DepartureStopNameZh,DestinationStopNameZh:t.DestinationStopNameZh,savedInFavorite:!0}):o.find((function(e,r){return e.RouteUID===t.RouteUID&&o.splice(r,1),e.RouteUID===t.RouteUID})),localStorage.setItem("favoriteRouteList",JSON.stringify(o))}}};const X=y()(V,[["render",K]]);var W=X,Q={name:"RouteSearchPanel",data:function(){return{}},components:{FavoriteBtn:W},props:["routesByKeywords"],emit:["setRouteCityAndNameForGetStops"],methods:{intervalRenewStops:function(e,t,r,o,n,a,i){this.$emit("setRouteCityAndNameForGetStops",e,t,r,o,n,a,i)}}};const ee=y()(Q,[["render",q]]);var te=ee,re={key:0,class:"h100 flex flex-direction-column"},oe={class:"flex jc-space-between px20 pt20-md mb10-md"},ne={class:"mb24"},ae={class:"text-center fz36 fw-bold"},ie={class:"flex jc-space-between cursor-pointer"},ce=Object(o["h"])(" 往 "),se={class:"fw-bold"},ue=Object(o["h"])(" 往 "),le={class:"fw-bold"},pe={class:"h100 overflow-scroll"},fe=["onClick","onMouseover"],he={class:"px32 flex fz14 ai-center"},de={class:"mt12 mb12"},be={key:0,class:"me8 ml-auto color-secondary"},me={key:0,class:"material-icons vertical-align-middle"},ve={key:1,class:"me8 ml-auto color-secondary"},Oe={key:0,class:"material-icons vertical-align-middle"},ge={class:"vechileProgressBar"},we=Object(o["f"])("div",{class:"bg-color-secondary timeBar",id:"timeBar"},null,-1);function ye(e,t,r,n,a,i){var c=Object(o["z"])("FavoriteBtn");return 0!==Object.keys(a.stopsOfTheRoute).length?(Object(o["s"])(),Object(o["e"])("div",re,[Object(o["f"])("div",oe,[Object(o["f"])("p",{onClick:t[0]||(t[0]=function(e){return i.backToHomeOrFavorite(r.prePage)}),class:"cursor-pointer"}," ❮ 返回搜尋 "),Object(o["i"])(c,{route:a.stopsOfTheRoute,onSaveToFavorite:i.saveToFavorite},null,8,["route","onSaveToFavorite"])]),Object(o["f"])("div",ne,[Object(o["f"])("h3",ae,Object(o["B"])(a.stopsOfTheRoute.RouteName.Zh_tw),1)]),Object(o["f"])("ul",ie,[Object(o["f"])("li",{onClick:t[1]||(t[1]=function(e){return i.changeDirection(0)}),class:Object(o["o"])(["w50 text-center py10 border-rounded-top",{"bg-primary-color-white":a.direction0Active,"bg-grey400-color-grey900":!a.direction0Active}])},[Object(o["f"])("p",null,[ce,Object(o["f"])("span",se,Object(o["B"])(a.stopsOfTheRoute.DestinationStopNameZh),1)])],2),Object(o["f"])("li",{onClick:t[2]||(t[2]=function(e){return i.changeDirection(1)}),class:Object(o["o"])(["w50 text-center py10 border-rounded-top",{"bg-primary-color-white":!a.direction0Active,"bg-grey400-color-grey900":a.direction0Active}])},[Object(o["f"])("p",null,[ue,Object(o["f"])("span",le,Object(o["B"])(a.stopsOfTheRoute.DepartureStopNameZh),1)])],2)]),Object(o["f"])("ul",pe,[(Object(o["s"])(!0),Object(o["e"])(o["a"],null,Object(o["y"])(a.stopsOfTheRoute.Stops,(function(t,r){return Object(o["s"])(),Object(o["e"])("li",{key:r,class:"pos-relative cursor-pointer hover-bg-grey",onClick:function(t){return e.$emit("renewPopMarker",r)},onMouseover:function(t){return e.$emit("renewPopMarker",r)}},[Object(o["f"])("div",he,[Object(o["f"])("p",{class:Object(o["o"])(["mt12 mb12 border-rounded busNotInService p5 me18 w20 text-center",[{busStopByStop:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime},{busWillStop:"number"===typeof t.EstimateTime}]])},Object(o["B"])(t.EstimateTime),3),Object(o["f"])("p",de,Object(o["B"])(t.StopName.Zh_tw),1),t.busDeparture?(Object(o["s"])(),Object(o["e"])("b",be,[Object(o["f"])("ul",null,[(Object(o["s"])(!0),Object(o["e"])(o["a"],null,Object(o["y"])(t.busDeparture,(function(e,t){return Object(o["s"])(),Object(o["e"])("li",{key:t},[Object(o["h"])(Object(o["B"])(e.PlateNumb),1),e.VehicleType?(Object(o["s"])(),Object(o["e"])("span",me," accessible_forward ")):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0),t.busArrival?(Object(o["s"])(),Object(o["e"])("b",ve,[Object(o["f"])("ul",null,[(Object(o["s"])(!0),Object(o["e"])(o["a"],null,Object(o["y"])(t.busArrival,(function(e,t){return Object(o["s"])(),Object(o["e"])("li",{key:t},[Object(o["h"])(Object(o["B"])(e.PlateNumb),1),e.VehicleType?(Object(o["s"])(),Object(o["e"])("span",Oe," accessible_forward ")):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0)]),Object(o["f"])("span",ge,[Object(o["f"])("span",{class:Object(o["o"])(["vechileProgressBar-before",[{busArrival:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime},{"visibility-hidden":0===r}]])},null,2),Object(o["f"])("span",{class:Object(o["o"])(["vechileProgressBar-dot",{busStopByStop:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime}])},null,2),Object(o["f"])("span",{class:Object(o["o"])(["vechileProgressBar-after",[{"visibility-hidden":r===a.stopsOfTheRoute.Stops.length-1}]])},null,2)])],40,fe)})),128))]),we])):Object(o["d"])("",!0)}var je={data:function(){return{nowDirection:0,stopsOfTheRoute:this.allDirectionStopsOfTheRoute[0]||[],direction0Active:!0,updateDataInterval:{},timeBarInterval:{}}},props:["allDirectionStopsOfTheRoute","prePage"],emit:["changeRoutesToAll","setRouteCityAndNameForGetStops","renewFavoriteList","renewPopMarker","resetNowDirection"],components:{FavoriteBtn:W},watch:{allDirectionStopsOfTheRoute:function(){this.stopsOfTheRoute=this.allDirectionStopsOfTheRoute[this.nowDirection]||[]}},methods:{changeDirection:function(e){this.nowDirection=e,this.stopsOfTheRoute=this.allDirectionStopsOfTheRoute[e],this.$emit("changeDirection",e),this.direction0Active=!this.direction0Active},saveToFavorite:function(e){this.allDirectionStopsOfTheRoute.forEach((function(t){t.savedInFavorite=e})),this.$emit("renewFavoriteList",e,this.stopsOfTheRoute.RouteUID)},backToHomeOrFavorite:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"home";"favorite"===e?this.$router.replace({query:{routes:"favorite"}}):this.$router.replace({path:"/"}),this.$emit("changeRoutesToAll")}},mounted:function(){console.log("prePage",this.prePage);var e=this,t=document.getElementById("timeBar").clientWidth,r=t;this.updateDataInterval=setInterval((function(){document.getElementById("timeBar").style.width=t+"px",r=t+t/30,e.$emit("setRouteCityAndNameForGetStops",e.stopsOfTheRoute.City,e.stopsOfTheRoute.RouteName.Zh_tw,e.stopsOfTheRoute.RouteUID,e.stopsOfTheRoute.DepartureStopNameZh,e.stopsOfTheRoute.DestinationStopNameZh,e.stopsOfTheRoute.CityName,e.stopsOfTheRoute.savedInFavorite),console.log("=========== NEW DATA +++++++++++++++ "),console.log(t,r)}),1e4),this.timeBarInterval=setInterval((function(){r-=t/10,document.getElementById("timeBar").style.width=r+"px"}),1e3)},beforeUnmount:function(){clearInterval(this.updateDataInterval),clearInterval(this.timeBarInterval),console.log("=========== NO DATA +++++++++++++++")},unmounted:function(){this.$emit("renewPopMarker",void 0),this.$emit("resetNowDirection")}};const Re=y()(je,[["render",ye]]);var xe=Re,Se=r("a0be"),Ne={data:function(){return{routes:[],allRoutes:[],favoriteRoutes:[],routesByKeywords:[],allDirectionStopsOfTheRoute:[],stopsOfTheRoute:[],stops:[],mapCenter:{Lat:"22.997572",Lon:"120.196029"},cityOfRoute:"",routeName:"",vehicleOfTaiwan:[],cityList:[],vechile:"",routeGEOJSON:{},originalClientY:0,nowClientY:0,windowHeight:0,originalBoardHeight:0,newBoardHeight:0,touchInfoPanel:"",showAlartOfNoFavoriteRoute:"",intervalRenewStops:"",RouteUID:"",DepartureStopNameZh:"",DestinationStopNameZh:"",CityName:"",savedInFavorite:"",nowDirection:0,nowPage:"home",popMarker:void 0}},components:{RouteSearchPanel:te,Map:Se["a"],StopsListPanel:xe},mixins:[M["a"]],watch:{"$route.query":{handler:function(e){"favorite"!==e.routes&&0!==Object.keys(e).length||this.changeRoutesToFavoritesOrAll("favorite"===e.routes),this.nowPage="favorite"===e.routes?"favorite":0===Object.keys(e).length?"home":this.nowPage},deep:!0},routeName:function(){""===this.routeName&&"favorite"!==this.$route.query.routes?this.routesByKeywords=[]:this.filterRouteByKeywords(this.routeName)}},methods:{consoleLogHaHa:function(e){console.log(e.target.value),console.log(e.target["data-value"]),console.log(e)},renewPopMarker:function(e){void 0!==e&&(this.mapCenter.Lat=this.stops[e].StopPosition.PositionLat,this.mapCenter.Lon=this.stops[e].StopPosition.PositionLon),this.popMarker=e},renewFavoriteList:function(e,t){var r=this.routes.find((function(e){return e.RouteUID===t}));r.savedInFavorite=e},focusInput:function(e){document.getElementById(e).focus()},setOriginalClientY:function(e){console.log(e),this.originalClientY=e.touches?e.touches[0].clientY:e.clientY,this.touchInfoPanel=!0},changeTargetHeight:function(e){this.touchInfoPanel&&(this.nowClientY=e.changedTouches?e.changedTouches[0].clientY:e.clientY,this.originalBoardHeight=document.getElementById("infoPanel").offsetHeight,this.newBoardHeight=this.originalBoardHeight+(this.originalClientY-this.nowClientY),document.getElementById("infoPanel").style.height=this.newBoardHeight>=this.windowHeight?this.windowHeight+"px":this.newBoardHeight<=200?"200px":this.newBoardHeight+"px",this.originalClientY=this.nowClientY)},changeDirectionForMap:function(e){this.nowDirection=e,this.stopsOfTheRoute=this.allDirectionStopsOfTheRoute[e],this.stops=this.stopsOfTheRoute.Stops},filterRouteByKeywords:function(e){this.routesByKeywords=[];var t=this,r=new RegExp(e);this.routes.forEach((function(e){(r.test(e.RouteName.Zh_tw+"*")||r.test(e.DepartureStopNameZh+"*")||r.test(e.DestinationStopNameZh+"*"))&&t.routesByKeywords.push(e)}))},changeRoutesToFavoritesOrAll:function(e){var t=this;return Object(O["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.routeName="",t.stopsOfTheRoute=[],t.stops=[],t.routeGEOJSON="",o=localStorage.getItem("favoriteRouteList"),t.favoriteRouteList=o?JSON.parse(o):[],e?(t.routes=t.favoriteRouteList,t.routesByKeywords=t.favoriteRouteList,t.showAlartOfNoFavoriteRoute=0===t.favoriteRouteList.length?"還沒有收藏的站牌YO":""):(t.routes=t.allRoutes,t.showAlartOfNoFavoriteRoute="",t.routesByKeywords=[]);case 7:case"end":return r.stop()}}),r)})))()},setRouteCityAndNameForGetStops:function(e,t,r,o,n,a,i){var c=this;return Object(O["a"])(regeneratorRuntime.mark((function s(){var u,l;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return c.$router.replace({query:{cityOfRoute:e,routeName:t,RouteUID:r,DepartureStopNameZh:o,DestinationStopNameZh:n,CityName:a}}),c.cityOfRoute=e,c.routeName=t,c.RouteUID=r,c.DepartureStopNameZh=o,c.DestinationStopNameZh=n,c.CityName=a,c.savedInFavorite=i,u=c,s.next=11,u.sortRealTimeNearStopAndEstimatedTimeByStopsOfTheRoute(c.vehicleOfTaiwan,e,t,r);case 11:return c.allDirectionStopsOfTheRoute=s.sent,s.next=14,u.allDirectionStopsOfTheRoute.forEach((function(e){e.DepartureStopNameZh=o,e.DestinationStopNameZh=n,e.CityName=a,e.savedInFavorite=i}));case 14:return s.next=16,u.allDirectionStopsOfTheRoute[u.nowDirection];case 16:return u.stopsOfTheRoute=s.sent,s.next=19,c.getRouteGEOJSON(e,r);case 19:c.routeGEOJSON=s.sent,u.stops=u.stopsOfTheRoute.Stops,l=void 0===c.popMarker?parseInt(u.stops.length/2):c.popMarker,u.mapCenter.Lat=u.stops[l].StopPosition.PositionLat,u.mapCenter.Lon=u.stops[l].StopPosition.PositionLon;case 24:case"end":return s.stop()}}),s)})))()}},mounted:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.windowHeight=document.getElementById("infoPanel").offsetHeight/.9;case 1:case"end":return t.stop()}}),t)})))()},created:function(){var e=this;return Object(O["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e,Object(O["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r.getCityList();case 2:return r.cityList=e.sent,e.t0=r,e.next=6,r.cityList;case 6:return e.t1=e.sent,e.next=9,e.t0.getRoutesOfTaiwan.call(e.t0,e.t1);case 9:return r.allRoutes=e.sent,r.changeRoutesToFavoritesOrAll("favorite"===r.$route.query.routes),e.t2=r,e.next=14,r.cityList;case 14:return e.t3=e.sent,e.next=17,e.t2.getVehicleOfTaiwan.call(e.t2,e.t3);case 17:r.vehicleOfTaiwan=e.sent,r.$route.query.cityOfRoute&&r.$route.query.routeName&&r.$route.query.RouteUID&&r.$route.query.DepartureStopNameZh&&r.$route.query.DestinationStopNameZh&&r.$route.query.CityName&&r.setRouteCityAndNameForGetStops(r.$route.query.cityOfRoute,r.$route.query.routeName,r.$route.query.RouteUID,r.$route.query.DepartureStopNameZh,r.$route.query.DestinationStopNameZh,r.$route.query.CityName);case 19:case"end":return e.stop()}}),e)})))();case 2:case"end":return t.stop()}}),t)})))()}};r("c72b");const Te=y()(Ne,[["render",F]]);var ke=Te,De=[{path:"/",name:"Home",component:ke},{path:"/about",name:"About",component:function(){return r.e("about").then(r.bind(null,"f820"))}},{path:"/RouteDetail",name:"RouteDetail",component:function(){return r.e("RouteDetail").then(r.bind(null,"2022"))}}],Ce=Object(x["a"])({history:Object(x["b"])("/"),routes:De}),Ie=Ce;Object(o["c"])(R).use(Ie).mount("#app")},7341:function(e,t,r){"use strict";r("129c")},a0be:function(e,t,r){"use strict";var o=r("7a23"),n=["id"];function a(e,t,r,a,i,c){return Object(o["s"])(),Object(o["e"])("div",{id:r.mapId},null,8,n)}r("d3b7"),r("159b"),r("99af"),r("d81d");var i=r("e11e"),c=r.n(i),s={name:"Map",props:["mapId","mapCenter","stops","routeGEOJSON","popMarker"],data:function(){return{map:{},markers:{},layer:c.a.layerGroup(this.markers),layerPostalcodes:{},geolayerGroup:{}}},watch:{popMarker:function(e){void 0!==e&&this.markers[e].openPopup()},routeGEOJSON:function(){this.showRouteOnMap(this.routeGEOJSON),console.log(this.routeGEOJSON)},stops:function(){var e=this;this.layer.remove();var t=[];this.stops.forEach((function(r){var o="將進站"===r.EstimateTime||"進站中"===r.EstimateTime?"bg-color-secondary":"number"===typeof r.EstimateTime?"bg-color-primary":"bg-color-grey550",n=e.newMarker(r.StopSequence,r.StopPosition.PositionLat,r.StopPosition.PositionLon,o);n.bindPopup("".concat(r.StopName.Zh_tw,"<br><b>").concat(r.EstimateTime,"</b>"),{closeButton:!1,className:o}),t.push(n)})),this.markers=t,this.layer=c.a.layerGroup(this.markers),this.layer.addTo(this.map)},mapCenter:{handler:function(){this.map.panTo([this.mapCenter.Lat,this.mapCenter.Lon])},deep:!0}},methods:{initalLeafletMap:function(e,t,r){this.map=c.a.map(e,{center:[t,r],zoom:15}),c.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:25,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoibG9ic3RlcjAxIiwiYSI6ImNrdXdvN3prYTUyYXgyb3BoaThwcmcxN2cifQ.CsAL1uSEtZjpGwuEpYA-6A"}).addTo(this.map)},newMarker:function(e,t,r,o){var n=c.a.divIcon({html:'<div class="locationIcon '.concat(o,'"><span>').concat(e,"</span></div>"),iconSize:[20,20],iconAnchor:[0,0],popupAnchor:[10,0]});return c.a.marker([t,r],{icon:n,clickable:!0})},showRouteOnMap:function(e){this.map.removeLayer(this.geolayerGroup),this.layerPostalcodes=new c.a.GeoJSON(e,{style:{color:"#355F8B",weight:5}}),this.geolayerGroup=new c.a.LayerGroup,this.geolayerGroup.addTo(this.map),this.geolayerGroup.addLayer(this.layerPostalcodes)}},mounted:function(){this.initalLeafletMap(this.mapId,this.mapCenter.Lat,this.mapCenter.Lon)}},u=(r("7341"),r("6b0d")),l=r.n(u);const p=l()(s,[["render",a]]);t["a"]=p},ac32:function(e,t,r){"use strict";r("4f2b")},c72b:function(e,t,r){"use strict";r("0e3f")},e33f:function(e,t,r){"use strict";var o=r("2909"),n=r("b85c"),a=r("1da1"),i=(r("d3b7"),r("159b"),r("d81d"),r("99af"),r("a15b"),r("4e82"),r("4de4"),r("3ca3"),r("ddb0"),r("7db0"),r("96cf"),r("6c2d")),c=r("bc3a"),s=r.n(c);t["a"]={data:function(){return{}},methods:{getCityList:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://gist.motc.gov.tw/gist_api/V3/Map/Basic/City?$format=JSON",t.prev=1,t.next=4,s.a.get(r,{headers:e.getAuthorizationHeader()});case 4:return o=t.sent,t.next=7,o.data;case 7:return t.abrupt("return",t.sent);case 10:t.prev=10,t.t0=t["catch"](1),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()},getAuthorizationHeader:function(){var e="6881a6e19c3240089c9d8cc87f52f52e",t="z274IyT03M2HixJY5cAbZn-8ccs",r=(new Date).toGMTString(),o=new i["a"]("SHA-1","TEXT");o.setHMACKey(t,"TEXT"),o.update("x-date: "+r);var n=o.getHMAC("B64"),a='hmac username="'.concat(e,'",algorithm="hmac-sha1",headers="x-date",signature="').concat(n,'"');return{Authorization:a,"X-Date":r}},getRoutesOfTheCity:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var n,a,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/".concat(e,"?$format=JSON"),o.prev=1,o.next=4,s.a.get("".concat(n),{headers:r.getAuthorizationHeader()});case 4:return a=o.sent,i=[],a.data.forEach((function(e){i.push({City:e.City,CityName:t,CityCode:e.CityCode,RouteUID:e.RouteUID,RouteMapImageUrl:e.RouteMapImageUrl,RouteName:e.RouteName,DepartureStopNameEn:e.DepartureStopNameEn,DepartureStopNameZh:e.DepartureStopNameZh,DestinationStopNameEn:e.DestinationStopNameEn,DestinationStopNameZh:e.DestinationStopNameZh})})),o.next=9,i;case 9:return o.abrupt("return",o.sent);case 12:o.prev=12,o.t0=o["catch"](1),console.log(o.t0);case 15:case"end":return o.stop()}}),o,null,[[1,12]])})))()},getRoutesOfTaiwan:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,i,c,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=[],r.next=3,e.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getRoutesOfTheCity(r.City,r.CityName);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:i=r.sent,c=Object(n["a"])(i),r.prev=5,c.s();case 7:if((s=c.n()).done){r.next=16;break}return u=s.value,r.t0=o,r.next=12,u;case 12:r.t1=r.sent,o=r.t0.concat.call(r.t0,r.t1);case 14:r.next=7;break;case 16:r.next=21;break;case 18:r.prev=18,r.t2=r["catch"](5),c.e(r.t2);case 21:return r.prev=21,c.f(),r.finish(21);case 24:return r.t3=console,r.next=27,o;case 27:return r.t4=r.sent,r.t3.log.call(r.t3,"routesList",r.t4),r.next=31,o;case 31:return r.abrupt("return",r.sent);case 32:case"end":return r.stop()}}),r,null,[[5,18,21,24]])})))()},getVehicleNearStopOfTheRoute:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var n,a,i,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=["RouteName","Direction","RouteUID","StopUID","PlateNumb","A2EventType","StopName","SubRouteUID"],a=n.join("%2C"),i="https://ptx.transportdata.tw/MOTC/v2/Bus/RealTimeNearStop/City/".concat(e,"/").concat(t,"?$select=").concat(a,"&$format=JSON"),o.prev=3,o.next=6,s.a.get("".concat(i),{headers:r.getAuthorizationHeader()});case 6:return c=o.sent,o.next=9,c.data;case 9:return o.abrupt("return",o.sent);case 12:o.prev=12,o.t0=o["catch"](3),console.log(o.t0);case 15:case"end":return o.stop()}}),o,null,[[3,12]])})))()},getVehicleOfTheCity:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o="https://ptx.transportdata.tw/MOTC/v2/Bus/Vehicle/City/".concat(e,"?$filter=VehicleType%20eq%201&$format=JSON/"),r.prev=1,r.next=4,s.a.get("".concat(o),{headers:t.getAuthorizationHeader()});case 4:return n=r.sent,r.next=7,n.data;case 7:return r.abrupt("return",r.sent);case 10:r.prev=10,r.t0=r["catch"](1),console.log(r.t0);case 13:case"end":return r.stop()}}),r,null,[[1,10]])})))()},getVehicleOfTaiwan:function(e){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var o,i,c,s,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=[],r.next=3,e.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(r){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getVehicleOfTheCity(r.City);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:i=r.sent,c=Object(n["a"])(i),r.prev=5,c.s();case 7:if((s=c.n()).done){r.next=16;break}return u=s.value,r.t0=o,r.next=12,u;case 12:r.t1=r.sent,o=r.t0.concat.call(r.t0,r.t1);case 14:r.next=7;break;case 16:r.next=21;break;case 18:r.prev=18,r.t2=r["catch"](5),c.e(r.t2);case 21:return r.prev=21,c.f(),r.finish(21);case 24:return r.next=26,o;case 26:return r.abrupt("return",r.sent);case 27:case"end":return r.stop()}}),r,null,[[5,18,21,24]])})))()},getRouteGEOJSON:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var n,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="https://gist.motc.gov.tw/gist_api/V3/Map/Bus/Network/Route/City/".concat(e,"?$filter=RouteUID%20eq%20'").concat(t,"'&$format=GEOJSON"),o.prev=1,o.next=4,s.a.get("".concat(n),{headers:r.getAuthorizationHeader()});case 4:return a=o.sent,o.abrupt("return",a.data.features[0]);case 8:o.prev=8,o.t0=o["catch"](1),console.log(o.t0);case 11:case 12:case"end":return o.stop()}}),o,null,[[1,8]])})))()},getStopsOfTheRoute:function(e,t,r){var o=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/".concat(e,"/").concat(t,"?$filter=RouteUID%20%20eq%20'").concat(r,"'&$format=JSON"),n.prev=1,n.next=4,s.a.get(a,{headers:o.getAuthorizationHeader()});case 4:return i=n.sent,n.next=7,i.data;case 7:return n.abrupt("return",n.sent);case 10:n.prev=10,n.t0=n["catch"](1),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},getEstimatedTimeOfTheRoute:function(e,t){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function o(){var n,a,i,c,u,l,p;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=["RouteName","Direction","StopUID","StopName","EstimateTime","StopSequence","PlateNumb"],a=n.join("%2C"),i="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/".concat(e,"/").concat(t,"?&select=").concat(a,"&$format=JSON"),o.prev=3,o.next=6,s.a.get(i,{headers:r.getAuthorizationHeader()});case 6:return c=o.sent,c.data.sort((function(e,t){return e.Direction-t.Direction})),u=c.data.filter((function(e){return 0===e.Direction})),l=c.data.filter((function(e){return 1===e.Direction})),p=[u,l],o.next=13,p;case 13:return o.abrupt("return",o.sent);case 16:o.prev=16,o.t0=o["catch"](3),console.log(o.t0);case 19:case"end":return o.stop()}}),o,null,[[3,16]])})))()},sortRealTimeNearStopAndEstimatedTimeByStopsOfTheRoute:function(e,t,r,i){var c=this;return Object(a["a"])(regeneratorRuntime.mark((function s(){var u,l,p,f,h,d,b;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,c.getStopsOfTheRoute(t,r,i);case 2:return u=s.sent,s.next=5,c.getEstimatedTimeOfTheRoute(t,r);case 5:return l=s.sent,s.next=8,c.getVehicleNearStopOfTheRoute(t,r);case 8:return p=s.sent,s.t0=n["a"],s.next=12,u;case 12:s.t1=s.sent,f=(0,s.t0)(s.t1),s.prev=14,d=regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return b=h.value,t.next=3,p.filter((function(e){return e.Direction===b.Direction&&b.SubRouteUID===e.SubRouteUID}));case 3:if(r=t.sent,!r){t.next=7;break}return t.next=7,r.forEach(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(r){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,b.Stops.find((function(e){return r.StopUID===e.StopUID}));case 2:if(n=t.sent,a=e.find((function(e){if(e)return e.PlateNumb===r.PlateNumb})),a&&(r.VehicleType="無障礙公車"),0!==r.A2EventType){t.next=16;break}return t.next=8,n.busDeparture;case 8:if(!t.sent){t.next=12;break}t.t0=[].concat(Object(o["a"])(n.busDeparture),[r]),t.next=13;break;case 12:t.t0=[r];case 13:n.busDeparture=t.t0,t.next=25;break;case 16:if(1!==r.A2EventType){t.next=25;break}return t.next=19,n.busArrival;case 19:if(!t.sent){t.next=23;break}t.t1=[].concat(Object(o["a"])(n.busArrival),[r]),t.next=24;break;case 23:t.t1=[r];case 24:n.busArrival=t.t1;case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:if(n=l.find((function(e){return e[0]?e[0].Direction===b.Direction:null})),!n){t.next=11;break}return t.next=11,b.Stops.forEach(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var r,o,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.find((function(e){return e.StopUID===t.StopUID}));case 2:r=e.sent,r&&(o=r.EstimateTime,a=Math.floor(o/60),t.EstimateTime=void 0==o?"未發車":1===a?"將進站":0===a?"進站中":a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return t.stop()}}),t)})),f.s();case 17:if((h=f.n()).done){s.next=21;break}return s.delegateYield(d(),"t2",19);case 19:s.next=17;break;case 21:s.next=26;break;case 23:s.prev=23,s.t3=s["catch"](14),f.e(s.t3);case 26:return s.prev=26,f.f(),s.finish(26);case 29:return console.log("differentDirectionsStopsLists",u),s.abrupt("return",u);case 31:case"end":return s.stop()}}),s,null,[[14,23,26,29]])})))()}},created:function(){}}}});
//# sourceMappingURL=app.be736488.js.map