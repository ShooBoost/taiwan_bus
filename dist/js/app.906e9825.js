(function(e){function t(t){for(var o,i,c=t[0],s=t[1],u=t[2],p=0,h=[];p<c.length;p++)i=c[p],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(h.length)h.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],o=!0,c=1;c<r.length;c++){var s=r[c];0!==n[s]&&(o=!1)}o&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var o={},n={app:0},a=[];function i(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=o,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(r,o,function(t){return e[t]}.bind(null,o));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/taiwan_bus/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=s;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},1:function(e,t){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("6cc5");var o=r("7a23"),n={class:"flex flex-direction-column h100 pos-relative"},a={id:"nav",class:"w40-md w30-lg bg-color-white display-none display-block-md pos-absolute z-index99999 border-bottom-grey520"},i={class:"flex color-white jc-space-around ai-center"},c={class:"w100 text-center"},s=Object(o["g"])("directions_bus_filled"),u={class:"w100 text-center"},l={class:"w100 text-center"},p={class:"footer bg-color-white border-box pos-relative display-none-md border-top-grey520"},h={class:"flex h100 color-white jc-space-around ai-center"},f={class:"w100 text-center"},d=Object(o["g"])("directions_bus_filled"),b={class:"w100 text-center"},m={class:"w100 text-center"};function O(e,t,r,O,v,g){var w=Object(o["w"])("router-link"),y=Object(o["w"])("router-view");return Object(o["r"])(),Object(o["e"])("div",n,[Object(o["f"])("header",a,[Object(o["f"])("ul",i,[Object(o["f"])("li",c,[Object(o["h"])(w,{to:"/",class:Object(o["n"])(["border-box w100 p12 fz32 bg-white-color-primary",{"material-icons-round":v.showHome,"material-icons-outlined":!v.showHome}])},{default:Object(o["C"])((function(){return[s]})),_:1},8,["class"])]),Object(o["f"])("li",u,[Object(o["h"])(w,{to:"?routes=favorite",class:"material-icons-outlined border-box w100 p12 fz32 bg-white-color-primary"},{default:Object(o["C"])((function(){return[Object(o["g"])(Object(o["y"])(v.favoriteBorderOrFill),1)]})),_:1})]),Object(o["f"])("li",l,[Object(o["f"])("span",{onClick:t[0]||(t[0]=function(){return g.shareUrl&&g.shareUrl.apply(g,arguments)}),class:"material-icons-outlined border-box w100 p12 fz32 cursor-pointer bg-white-color-primary"}," link ")])])]),Object(o["h"])(y,{class:"w100 flex-grow-1 overflow-scroll"}),Object(o["f"])("footer",p,[Object(o["f"])("ul",h,[Object(o["f"])("li",f,[Object(o["h"])(w,{to:"/",class:Object(o["n"])(["border-box w100 p12 fz32 bg-white-color-primary",{"material-icons-round":v.showHome,"material-icons-outlined":!v.showHome}])},{default:Object(o["C"])((function(){return[d]})),_:1},8,["class"])]),Object(o["f"])("li",b,[Object(o["h"])(w,{to:"?routes=favorite",class:"material-icons-outlined border-box w100 p12 fz32 bg-white-color-primary"},{default:Object(o["C"])((function(){return[Object(o["g"])(Object(o["y"])(v.favoriteBorderOrFill),1)]})),_:1})]),Object(o["f"])("li",m,[Object(o["f"])("span",{onClick:t[1]||(t[1]=function(){return g.shareUrl&&g.shareUrl.apply(g,arguments)}),class:"material-icons-outlined border-box w100 p12 fz32 cursor-pointer bg-white-color-primary"}," ios_share ")])])])])}var v=r("1da1"),g=(r("96cf"),{data:function(){return{showHome:"favorite"!==this.$route.query.routes,favoriteBorderOrFill:"favorite"===this.$route.query.routes?"favorite":"favorite_border"}},watch:{showHome:function(){this.favoriteBorderOrFill=this.showHome?"favorite_border":"favorite"},"$route.query":{handler:function(e){this.showHome="favorite"!==e.routes},deep:!0}},methods:{shareUrl:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:navigator.share?navigator.share({title:"台灣公車查詢",text:"網頁連結:",url:t.$route.fullPath}).then((function(){console.log("成功！")})).catch((function(e){console.log("發生錯誤",e)})):(navigator.clipboard.writeText(window.location.href),o=e.target.textContent,e.target.classList.remove("fz32"),e.target.classList.add("fz20"),e.target.classList.add("pointer-event-none"),e.target.classList.remove("pointer-event-initial"),e.target.textContent="網址複製成功",setTimeout((function(){e.target.textContent=o,e.target.classList.add("fz32"),e.target.classList.remove("fz20"),e.target.classList.add("pointer-event-initial"),e.target.classList.remove("pointer-event-none")}),2e3));case 1:case"end":return r.stop()}}),r)})))()}},created:function(){}}),w=(r("a374"),r("6b0d")),y=r.n(w);const j=y()(g,[["render",O]]);var R=j,x=r("6c02"),N=(r("b64b"),r("d3b7"),r("25f0"),r("fb6a"),{class:"flex-md w100 pos-relative border-box"}),S={id:"infoPanel",class:"w100 w40-md w30-lg h90 h100-md pos-absolute pos-relative-md b0 z-index9999 bg-color-white flex flex-direction-column border-rounded-top-24 border-rounded-none-md pt68-md border-box"},C={class:"px32"},k={key:0,class:"text-center pt12"},D={class:"w100 py12 px22 border-box fz20"},T={class:"w100 gap10 flex jc-space-around mb10"},I={class:"w100 gap10 flex jc-space-around mb10"},E={class:"w100 gap10 flex jc-space-around mb10"},F={class:"w100 gap10 flex jc-space-around"},P={key:1,class:"overflow-scroll flex-grow-1"},B={class:"w100 w60-md w70-lg h100"};function A(e,t,r,n,a,i){var c=Object(o["w"])("RouteSearchPanel"),s=Object(o["w"])("StopsListPanel"),u=Object(o["w"])("Map");return Object(o["r"])(),Object(o["e"])("div",N,[Object(o["f"])("section",S,[Object(o["f"])("div",{onTouchstart:t[0]||(t[0]=Object(o["E"])((function(){return i.setOriginalClientY&&i.setOriginalClientY.apply(i,arguments)}),["prevent","self"])),onTouchmove:t[1]||(t[1]=Object(o["E"])((function(){return i.changeTargetHeight&&i.changeTargetHeight.apply(i,arguments)}),["prevent","self"])),onTouchend:t[2]||(t[2]=Object(o["E"])((function(e){return a.touchingInfoPanelOrNot=!1}),["prevent","self"])),onMousedown:t[3]||(t[3]=Object(o["E"])((function(){return i.setOriginalClientY&&i.setOriginalClientY.apply(i,arguments)}),["prevent","self"])),onMousemove:t[4]||(t[4]=Object(o["E"])((function(){return i.changeTargetHeight&&i.changeTargetHeight.apply(i,arguments)}),["prevent","self"])),onMouseup:t[5]||(t[5]=Object(o["E"])((function(e){return a.touchingInfoPanelOrNot=!1}),["prevent"])),class:"py12 text-center material-icons-round fw-bold cursor-pointer display-none-md"}," horizontal_rule ",32),0===Object.keys(a.chosenDirectionOfChosenRoute).length?(Object(o["r"])(),Object(o["e"])("div",{key:0,class:Object(o["n"])(["flex flex-direction-column overflow-scroll flex-grow-1",{"jc-center":a.signOfEmptyFavoriteRoute}])},[Object(o["f"])("div",C,[Object(o["D"])(Object(o["f"])("input",{id:"inputOfSearchRoute",class:"w100 border-box mb20 bg-color-grey300 border-none p12 border-rounded-10-md","onUpdate:modelValue":t[6]||(t[6]=function(e){return a.routeName=e}),placeholder:"🔍"},null,512),[[o["A"],a.routeName]])]),a.signOfEmptyFavoriteRoute?(Object(o["r"])(),Object(o["e"])("p",k,Object(o["y"])(a.signOfEmptyFavoriteRoute),1)):Object(o["d"])("",!0),Object(o["h"])(c,{routesByKeywords:a.currentRoutesFilterByKeywords,onGetStopsOfRoute:i.getStopsOfRoute,class:"overflow-scroll flex-grow-1"},null,8,["routesByKeywords","onGetStopsOfRoute"]),Object(o["f"])("div",D,[Object(o["f"])("div",T,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-red color-white fw-bold cursor-pointer",onClick:t[7]||(t[7]=function(e){return a.routeName=a.routeName.toString()+"紅"})}," 紅 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-blue color-white fw-bold cursor-pointer",onClick:t[8]||(t[8]=function(e){return a.routeName=a.routeName.toString()+"藍"})}," 藍 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[9]||(t[9]=function(e){return a.routeName=a.routeName.toString()+"1"})}," 1 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[10]||(t[10]=function(e){return a.routeName=a.routeName.toString()+"2"})}," 2 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[11]||(t[11]=function(e){return a.routeName=a.routeName.toString()+"3"})}," 3 ")]),Object(o["f"])("div",I,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-green color-white fw-bold cursor-pointer",onClick:t[12]||(t[12]=function(e){return a.routeName=a.routeName.toString()+"綠"})}," 綠 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-brown color-white fw-bold cursor-pointer",onClick:t[13]||(t[13]=function(e){return a.routeName=a.routeName.toString()+"棕"})}," 棕 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[14]||(t[14]=function(e){return a.routeName=a.routeName.toString()+"4"})}," 4 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[15]||(t[15]=function(e){return a.routeName=a.routeName.toString()+"5"})}," 5 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[16]||(t[16]=function(e){return a.routeName=a.routeName.toString()+"6"})}," 6 ")]),Object(o["f"])("div",E,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-orange color-white fw-bold cursor-pointer",onClick:t[17]||(t[17]=function(e){return a.routeName=a.routeName.toString()+"橘"})}," 橘 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-yellow color-white fw-bold cursor-pointer",onClick:t[18]||(t[18]=function(e){return a.routeName=a.routeName.toString()+"黃"})}," 黃 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[19]||(t[19]=function(e){return a.routeName=a.routeName.toString()+"7"})}," 7 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[20]||(t[20]=function(e){return a.routeName=a.routeName.toString()+"8"})}," 8 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[21]||(t[21]=function(e){return a.routeName=a.routeName.toString()+"9"})}," 9 ")]),Object(o["f"])("div",F,[Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey600 color-white fw-bold cursor-pointer",onClick:t[22]||(t[22]=function(e){return a.routeName=a.routeName.toString()+"F"})}," F "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey600 color-white fw-bold cursor-pointer",onClick:t[23]||(t[23]=function(e){return a.routeName=a.routeName.toString()+"小"})}," 小 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-kb-black color-white cursor-pointer",onClick:t[24]||(t[24]=function(e){return i.focusInput("inputOfSearchRoute")})}," 其他 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[25]||(t[25]=function(e){return a.routeName=a.routeName.toString()+"0"})}," 0 "),Object(o["f"])("div",{class:"py12 border-rounded w100 text-center bg-color-grey500 cursor-pointer",onClick:t[26]||(t[26]=function(e){return a.routeName=a.routeName.toString().slice(0,-1)})}," 清除 ")])])],2)):(Object(o["r"])(),Object(o["e"])("div",P,[Object(o["h"])(s,{class:"h100",allDirectionsOfTheChosenRoute:a.allDirectionsOfTheChosenRoute,prePage:a.nowPage,onRenewStopsOfRoute:i.getStopsOfRoute,onChangeDirection:i.changeDirectionForMap,onChangeRoutesToAll:i.showFavoriteRoutesOrAllRoutesOfTaiwan,onRenewFavoriteRoutes:i.renewFavoriteRoutes,onRenewPopMarker:i.renewPopMarker,onResetNowDirection:t[27]||(t[27]=function(e){return a.indexOfChosenDirection=0})},null,8,["allDirectionsOfTheChosenRoute","prePage","onRenewStopsOfRoute","onChangeDirection","onChangeRoutesToAll","onRenewFavoriteRoutes","onRenewPopMarker"])]))]),Object(o["f"])("section",B,[Object(o["h"])(u,{class:"w100 h100",mapId:"homeMap",mapCenter:a.mapCenter,stops:a.stopsOfChosenDirection,routeGEOJSON:a.routeGEOJSON,popMarker:a.popMarker},null,8,["mapCenter","stops","routeGEOJSON","popMarker"])])])}r("7db0"),r("4d63"),r("c607"),r("ac1f"),r("2c3e"),r("159b"),r("00b4"),r("4de4"),r("5319");var M=r("2909"),Z=r("b85c"),U=(r("99af"),r("4e82"),r("a15b"),r("3ca3"),r("ddb0"),r("4328")),L=r.n(U),$=r("bc3a"),_=r.n($),H={data:function(){return{}},methods:{getCityList:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r="https://tdx.transportdata.tw/api/basic/v2/Basic/City?%24format=JSON",t.prev=1,t.t0=_.a,t.t1=r,t.next=6,e.getAuthorizationHeader();case 6:return t.t2=t.sent,t.t3={headers:t.t2},t.next=10,t.t0.get.call(t.t0,t.t1,t.t3);case 10:return o=t.sent,t.next=13,o.data;case 13:return t.abrupt("return",t.sent);case 16:t.prev=16,t.t4=t["catch"](1),console.log("台灣所有縣市的名稱",t.t4);case 19:case"end":return t.stop()}}),t,null,[[1,16]])})))()},getAuthorizationHeader:function(){return Object(v["a"])(regeneratorRuntime.mark((function e(){var t,r,o,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={grant_type:"client_credentials",client_id:"shooboost-0659506a-9440-4f49",client_secret:"f075a3b1-3567-47d5-9926-e413ba6d3d42"},r="https://tdx.transportdata.tw/auth/realms/TDXConnect/protocol/openid-connect/token",e.prev=2,e.next=5,_()({method:"POST",url:r,data:L.a.stringify(t),headers:{"content-type":"application/x-www-form-urlencoded"}});case 5:return o=e.sent,n=o.data,e.abrupt("return",{authorization:"Bearer ".concat(n.access_token)});case 10:return e.prev=10,e.t0=e["catch"](2),e.abrupt("return",e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})))()},getRoutesOfTheCity:function(e,t){var r=this;return Object(v["a"])(regeneratorRuntime.mark((function o(){var n,a,i;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="https://tdx.transportdata.tw/api/basic/v2/Bus/Route/City/".concat(e,"?$format=JSON"),o.prev=1,o.t0=_.a,o.t1="".concat(n),o.next=6,r.getAuthorizationHeader();case 6:return o.t2=o.sent,o.t3={headers:o.t2},o.next=10,o.t0.get.call(o.t0,o.t1,o.t3);case 10:return a=o.sent,i=[],a.data.forEach((function(e){i.push({City:e.City,CityName:t,CityCode:e.CityCode,RouteUID:e.RouteUID,RouteMapImageUrl:e.RouteMapImageUrl,RouteName:e.RouteName,DepartureStopNameEn:e.DepartureStopNameEn,DepartureStopNameZh:e.DepartureStopNameZh,DestinationStopNameEn:e.DestinationStopNameEn,DestinationStopNameZh:e.DestinationStopNameZh})})),o.next=15,i;case 15:return o.abrupt("return",o.sent);case 18:o.prev=18,o.t4=o["catch"](1),console.log(o.t4);case 21:case"end":return o.stop()}}),o,null,[[1,18]])})))()},getRoutesOfTaiwan:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o,n,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:o=[],n=[],a=Object(Z["a"])(e),r.prev=3,a.s();case 5:if((i=a.n()).done){r.next=14;break}return c=i.value,r.t0=n,r.next=10,t.getRoutesOfTheCity(c.City,c.CityName);case 10:r.t1=r.sent,r.t0.push.call(r.t0,r.t1);case 12:r.next=5;break;case 14:r.next=19;break;case 16:r.prev=16,r.t2=r["catch"](3),a.e(r.t2);case 19:return r.prev=19,a.f(),r.finish(19);case 22:s=0,u=n;case 23:if(!(s<u.length)){r.next=33;break}return l=u[s],r.t3=o,r.next=28,l;case 28:r.t4=r.sent,o=r.t3.concat.call(r.t3,r.t4);case 30:s++,r.next=23;break;case 33:return o.sort((function(e,t){return e.RouteName.Zh_tw.localeCompare(t.RouteName.Zh_tw,"zh-TW")})),r.next=36,o;case 36:return r.abrupt("return",r.sent);case 37:case"end":return r.stop()}}),r,null,[[3,16,19,22]])})))()},getVehicleNearStopOfTheRoute:function(e,t){var r=this;return Object(v["a"])(regeneratorRuntime.mark((function o(){var n,a,i,c;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=["RouteName","Direction","RouteUID","StopUID","PlateNumb","A2EventType","StopName","SubRouteUID"],a=n.join("%2C"),i="https://tdx.transportdata.tw/api/basic/v2/Bus/RealTimeNearStop/City/".concat(e,"/").concat(t,"?$select=").concat(a,"&$format=JSON"),o.prev=3,o.t0=_.a,o.t1="".concat(i),o.next=8,r.getAuthorizationHeader();case 8:return o.t2=o.sent,o.t3={headers:o.t2},o.next=12,o.t0.get.call(o.t0,o.t1,o.t3);case 12:return c=o.sent,o.next=15,c.data;case 15:return o.abrupt("return",o.sent);case 18:o.prev=18,o.t4=o["catch"](3),console.log(o.t4);case 21:case"end":return o.stop()}}),o,null,[[3,18]])})))()},getVehicleOfTheCity:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o="https://tdx.transportdata.tw/api/basic/v2/Bus/Vehicle/City/".concat(e,"?$filter=VehicleType%20eq%201&$format=JSON/"),r.prev=1,r.t0=_.a,r.t1="".concat(o),r.next=6,t.getAuthorizationHeader();case 6:return r.t2=r.sent,r.t3={headers:r.t2},r.next=10,r.t0.get.call(r.t0,r.t1,r.t3);case 10:return n=r.sent,r.next=13,n.data;case 13:return r.abrupt("return",r.sent);case 16:r.prev=16,r.t4=r["catch"](1),console.log(r.t4);case 19:case"end":return r.stop()}}),r,null,[[1,16]])})))()},getVehicleOfTaiwan:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o,n,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:o=[],n=[],a=Object(Z["a"])(e),r.prev=3,a.s();case 5:if((i=a.n()).done){r.next=16;break}if(c=i.value,"Chiayi"!==c.City){r.next=9;break}return r.abrupt("continue",14);case 9:return r.t0=n,r.next=12,t.getVehicleOfTheCity(c.City);case 12:r.t1=r.sent,r.t0.push.call(r.t0,r.t1);case 14:r.next=5;break;case 16:r.next=21;break;case 18:r.prev=18,r.t2=r["catch"](3),a.e(r.t2);case 21:return r.prev=21,a.f(),r.finish(21);case 24:s=0,u=n;case 25:if(!(s<u.length)){r.next=35;break}return l=u[s],r.t3=o,r.next=30,l;case 30:r.t4=r.sent,o=r.t3.concat.call(r.t3,r.t4);case 32:s++,r.next=25;break;case 35:return r.next=37,o;case 37:return r.abrupt("return",r.sent);case 38:case"end":return r.stop()}}),r,null,[[3,18,21,24]])})))()},getRouteGEOJSON:function(e,t){var r=this;return Object(v["a"])(regeneratorRuntime.mark((function o(){var n,a;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n="https://tdx.transportdata.tw/api/basic/V3/Map/Bus/Network/StopOfRoute/City/".concat(e,"/RouteName/").concat(t,"?%24format=GEOJSON"),o.prev=1,o.t0=_.a,o.t1="".concat(n),o.next=6,r.getAuthorizationHeader();case 6:return o.t2=o.sent,o.t3={headers:o.t2},o.next=10,o.t0.get.call(o.t0,o.t1,o.t3);case 10:return a=o.sent,o.abrupt("return",a.data.features[0]);case 14:o.prev=14,o.t4=o["catch"](1),console.log(o.t4);case 17:case 18:case"end":return o.stop()}}),o,null,[[1,14]])})))()},getStopsOfTheRoute:function(e,t,r){var o=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var a,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a="https://tdx.transportdata.tw/api/basic/v2/Bus/StopOfRoute/City/".concat(e,"/").concat(t,"?$filter=RouteUID%20%20eq%20'").concat(r,"'&$format=JSON"),n.prev=1,n.t0=_.a,n.t1=a,n.next=6,o.getAuthorizationHeader();case 6:return n.t2=n.sent,n.t3={headers:n.t2},n.next=10,n.t0.get.call(n.t0,n.t1,n.t3);case 10:return i=n.sent,n.next=13,i.data;case 13:return n.abrupt("return",n.sent);case 16:n.prev=16,n.t4=n["catch"](1),console.log(n.t4);case 19:case"end":return n.stop()}}),n,null,[[1,16]])})))()},getEstimatedTimeOfTheRoute:function(e,t){var r=this;return Object(v["a"])(regeneratorRuntime.mark((function o(){var n,a,i,c,s,u,l;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return n=["RouteName","Direction","StopUID","StopName","EstimateTime","StopSequence","PlateNumb"],a=n.join("%2C"),i="https://tdx.transportdata.tw/api/basic/v2/Bus/EstimatedTimeOfArrival/City/".concat(e,"/").concat(t,"?&select=").concat(a,"&$format=JSON"),o.prev=3,o.t0=_.a,o.t1=i,o.next=8,r.getAuthorizationHeader();case 8:return o.t2=o.sent,o.t3={headers:o.t2},o.next=12,o.t0.get.call(o.t0,o.t1,o.t3);case 12:return c=o.sent,c.data.sort((function(e,t){return e.Direction-t.Direction})),s=c.data.filter((function(e){return 0===e.Direction})),u=c.data.filter((function(e){return 1===e.Direction})),l=[s,u],o.next=19,l;case 19:return o.abrupt("return",o.sent);case 22:o.prev=22,o.t4=o["catch"](3),console.log(o.t4);case 25:case"end":return o.stop()}}),o,null,[[3,22]])})))()},sortRealTimeNearStopAndEstimatedTimeByStopsOfTheRoute:function(e,t,r,o){var n=this;return Object(v["a"])(regeneratorRuntime.mark((function a(){var i,c,s,u,l,p,h;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,n.getStopsOfTheRoute(t,r,o);case 2:return i=a.sent,a.next=5,n.getEstimatedTimeOfTheRoute(t,r);case 5:return c=a.sent,a.next=8,n.getVehicleNearStopOfTheRoute(t,r);case 8:return s=a.sent,a.t0=Z["a"],a.next=12,i;case 12:a.t1=a.sent,u=(0,a.t0)(a.t1),a.prev=14,p=regeneratorRuntime.mark((function t(){var r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return h=l.value,t.next=3,s.filter((function(e){return e.Direction===h.Direction&&h.SubRouteUID===e.SubRouteUID}));case 3:if(r=t.sent,!r){t.next=7;break}return t.next=7,r.forEach(function(){var t=Object(v["a"])(regeneratorRuntime.mark((function t(r){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,h.Stops.find((function(e){return r.StopUID===e.StopUID}));case 2:if(o=t.sent,n=e.find((function(e){if(e)return e.PlateNumb===r.PlateNumb})),n&&(r.VehicleType="無障礙公車"),0!==r.A2EventType){t.next=16;break}return t.next=8,o.busDeparture;case 8:if(!t.sent){t.next=12;break}t.t0=[].concat(Object(M["a"])(o.busDeparture),[r]),t.next=13;break;case 12:t.t0=[r];case 13:o.busDeparture=t.t0,t.next=25;break;case 16:if(1!==r.A2EventType){t.next=25;break}return t.next=19,o.busArrival;case 19:if(!t.sent){t.next=23;break}t.t1=[].concat(Object(M["a"])(o.busArrival),[r]),t.next=24;break;case 23:t.t1=[r];case 24:o.busArrival=t.t1;case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 7:if(o=c.find((function(e){return e[0]?e[0].Direction===h.Direction:null})),!o){t.next=11;break}return t.next=11,h.Stops.forEach(function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var r,n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,o.find((function(e){return e.StopUID===t.StopUID}));case 2:r=e.sent,r&&(n=r.EstimateTime,a=Math.floor(n/60),t.EstimateTime=void 0==n?"未發車":1===a?"將進站":0===a?"進站中":a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 11:case"end":return t.stop()}}),t)})),u.s();case 17:if((l=u.n()).done){a.next=21;break}return a.delegateYield(p(),"t2",19);case 19:a.next=17;break;case 21:a.next=26;break;case 23:a.prev=23,a.t3=a["catch"](14),u.e(a.t3);case 26:return a.prev=26,u.f(),a.finish(26);case 29:return a.abrupt("return",i);case 30:case"end":return a.stop()}}),a,null,[[14,23,26,29]])})))()}}},z={class:""},G=["onClick"],J={class:""},q={key:0,class:"fz20 fw-bold mb4"},Y={class:"color-grey"},K={key:0},V={class:"text-center"},W={class:"color-grey"};function X(e,t,r,n,a,i){var c=Object(o["w"])("FavoriteBtn");return Object(o["r"])(),Object(o["e"])("ul",z,[(Object(o["r"])(!0),Object(o["e"])(o["a"],null,Object(o["v"])(r.routesByKeywords,(function(e,t){return Object(o["r"])(),Object(o["e"])("li",{key:t,class:"px32 cursor-pointer hover-bg-grey"},[Object(o["f"])("div",{onClick:function(t){return i.intervalRenewStops(e.City,e.RouteName.Zh_tw,e.RouteUID,e.DepartureStopNameZh,e.DestinationStopNameZh,e.CityName,e.savedInFavorite)},class:"flex jc-space-between border-bottom border-color-grey py12"},[Object(o["f"])("div",J,[e.RouteName?(Object(o["r"])(),Object(o["e"])("h6",q,Object(o["y"])(e.RouteName.Zh_tw),1)):Object(o["d"])("",!0),Object(o["f"])("p",Y,[e.DepartureStopNameZh?(Object(o["r"])(),Object(o["e"])("span",K,Object(o["y"])(e.DepartureStopNameZh)+" -",1)):Object(o["d"])("",!0),Object(o["g"])(" "+Object(o["y"])(e.DestinationStopNameZh),1)])]),Object(o["f"])("div",V,[Object(o["h"])(c,{route:e},null,8,["route"]),Object(o["f"])("p",W,Object(o["y"])(e.CityName.slice(0,2)),1)])],8,G)])})),128))])}var Q={key:0,class:"material-icons mb6 color-secondary"},ee={key:1,class:"material-icons mb6 hover-color-sencodary"};function te(e,t,r,n,a,i){return Object(o["r"])(),Object(o["e"])("div",{onClick:t[0]||(t[0]=Object(o["E"])((function(e){return i.saveToFavorite(!r.route.savedInFavorite,r.route)}),["stop"])),class:"cursor-pointer"},[r.route.savedInFavorite?(Object(o["r"])(),Object(o["e"])("span",Q," favorite ")):(Object(o["r"])(),Object(o["e"])("span",ee," favorite_border "))])}r("a434"),r("e9c4");var re={props:["route"],emit:["saveToFavorite"],methods:{saveToFavorite:function(e,t){var r=localStorage.getItem("favoriteRouteList"),o=r?JSON.parse(r):[];t.savedInFavorite=!!e,this.$emit("saveToFavorite",e),e?o.push({City:t.City,CityName:t.CityName,RouteName:{Zh_tw:t.RouteName.Zh_tw},RouteUID:t.RouteUID,DepartureStopNameZh:t.DepartureStopNameZh,DestinationStopNameZh:t.DestinationStopNameZh,savedInFavorite:!0}):o.find((function(e,r){return e.RouteUID===t.RouteUID&&o.splice(r,1),e.RouteUID===t.RouteUID})),localStorage.setItem("favoriteRouteList",JSON.stringify(o))}}};const oe=y()(re,[["render",te]]);var ne=oe,ae={name:"RouteSearchPanel",data:function(){return{}},components:{FavoriteBtn:ne},props:["routesByKeywords"],emit:["getStopsOfRoute"],methods:{intervalRenewStops:function(e,t,r,o,n,a,i){this.$emit("getStopsOfRoute",{cityOfRoute:e,routeName:t,RouteUID:r,DepartureStopNameZh:o,DestinationStopNameZh:n,CityName:a,savedInFavorite:i})}}};const ie=y()(ae,[["render",X]]);var ce=ie,se={key:0,class:"h100 flex flex-direction-column"},ue={class:"flex jc-space-between px20 pt20-md mb10-md"},le={class:"mb24"},pe={class:"text-center fz36 fw-bold"},he={class:"flex jc-space-between cursor-pointer"},fe=Object(o["g"])(" 往 "),de={class:"fw-bold"},be=Object(o["g"])(" 往 "),me={class:"fw-bold"},Oe={class:"h100 overflow-scroll"},ve=["onClick","onMouseover"],ge={class:"px32 flex fz14 ai-center"},we={class:"mt12 mb12"},ye={key:0,class:"me8 ml-auto color-secondary"},je={key:0,class:"material-icons vertical-align-middle"},Re={key:1,class:"me8 ml-auto color-secondary"},xe={key:0,class:"material-icons vertical-align-middle"},Ne={class:"vechileProgressBar"},Se=Object(o["f"])("div",{class:"bg-color-secondary timeBar",id:"timeBar"},null,-1);function Ce(e,t,r,n,a,i){var c=Object(o["w"])("FavoriteBtn");return 0!==Object.keys(a.stopsOfTheRoute).length?(Object(o["r"])(),Object(o["e"])("div",se,[Object(o["f"])("div",ue,[Object(o["f"])("p",{onClick:t[0]||(t[0]=function(e){return i.backToHomeOrFavorite(r.prePage)}),class:"cursor-pointer"}," ❮ 返回搜尋 "),Object(o["h"])(c,{route:a.stopsOfTheRoute,onSaveToFavorite:i.saveToFavorite},null,8,["route","onSaveToFavorite"])]),Object(o["f"])("div",le,[Object(o["f"])("h3",pe,Object(o["y"])(a.stopsOfTheRoute.RouteName.Zh_tw),1)]),Object(o["f"])("ul",he,[Object(o["f"])("li",{onClick:t[1]||(t[1]=function(e){return i.changeDirection(0)}),class:Object(o["n"])(["w50 text-center py10 border-rounded-top",{"bg-primary-color-white":a.direction0Active,"bg-grey400-color-grey900":!a.direction0Active}])},[Object(o["f"])("p",null,[fe,Object(o["f"])("span",de,Object(o["y"])(a.stopsOfTheRoute.DestinationStopNameZh),1)])],2),Object(o["f"])("li",{onClick:t[2]||(t[2]=function(e){return i.changeDirection(1)}),class:Object(o["n"])(["w50 text-center py10 border-rounded-top",{"bg-primary-color-white":!a.direction0Active,"bg-grey400-color-grey900":a.direction0Active}])},[Object(o["f"])("p",null,[be,Object(o["f"])("span",me,Object(o["y"])(a.stopsOfTheRoute.DepartureStopNameZh),1)])],2)]),Object(o["f"])("ul",Oe,[(Object(o["r"])(!0),Object(o["e"])(o["a"],null,Object(o["v"])(a.stopsOfTheRoute.Stops,(function(t,r){return Object(o["r"])(),Object(o["e"])("li",{key:r,class:"pos-relative cursor-pointer hover-bg-grey",onClick:function(t){return e.$emit("renewPopMarker",r)},onMouseover:function(t){return e.$emit("renewPopMarker",r)}},[Object(o["f"])("div",ge,[Object(o["f"])("p",{class:Object(o["n"])(["mt12 mb12 border-rounded busNotInService p5 me18 w20 text-center",[{busStopByStop:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime},{busWillStop:"number"===typeof t.EstimateTime}]])},Object(o["y"])(t.EstimateTime),3),Object(o["f"])("p",we,Object(o["y"])(t.StopName.Zh_tw),1),t.busDeparture?(Object(o["r"])(),Object(o["e"])("b",ye,[Object(o["f"])("ul",null,[(Object(o["r"])(!0),Object(o["e"])(o["a"],null,Object(o["v"])(t.busDeparture,(function(e,t){return Object(o["r"])(),Object(o["e"])("li",{key:t},[Object(o["g"])(Object(o["y"])(e.PlateNumb),1),e.VehicleType?(Object(o["r"])(),Object(o["e"])("span",je," accessible_forward ")):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0),t.busArrival?(Object(o["r"])(),Object(o["e"])("b",Re,[Object(o["f"])("ul",null,[(Object(o["r"])(!0),Object(o["e"])(o["a"],null,Object(o["v"])(t.busArrival,(function(e,t){return Object(o["r"])(),Object(o["e"])("li",{key:t},[Object(o["g"])(Object(o["y"])(e.PlateNumb),1),e.VehicleType?(Object(o["r"])(),Object(o["e"])("span",xe," accessible_forward ")):Object(o["d"])("",!0)])})),128))])])):Object(o["d"])("",!0)]),Object(o["f"])("span",Ne,[Object(o["f"])("span",{class:Object(o["n"])(["vechileProgressBar-before",[{busArrival:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime},{"visibility-hidden":0===r}]])},null,2),Object(o["f"])("span",{class:Object(o["n"])(["vechileProgressBar-dot",{busStopByStop:"將進站"===t.EstimateTime||"進站中"===t.EstimateTime}])},null,2),Object(o["f"])("span",{class:Object(o["n"])(["vechileProgressBar-after",[{"visibility-hidden":r===a.stopsOfTheRoute.Stops.length-1}]])},null,2)])],40,ve)})),128))]),Se])):Object(o["d"])("",!0)}var ke={data:function(){return{nowDirection:0,stopsOfTheRoute:this.allDirectionsOfTheChosenRoute[0]||[],direction0Active:!0,updateDataInterval:{},timeBarInterval:{}}},props:["allDirectionsOfTheChosenRoute","prePage"],emit:["changeRoutesToAll","renewStopsOfRoute","renewFavoriteRoutes","renewPopMarker","resetNowDirection"],components:{FavoriteBtn:ne},watch:{allDirectionsOfTheChosenRoute:function(){this.stopsOfTheRoute=this.allDirectionsOfTheChosenRoute[this.nowDirection]||[]}},methods:{changeDirection:function(e){this.nowDirection=e,this.stopsOfTheRoute=this.allDirectionsOfTheChosenRoute[e],this.$emit("changeDirection",e),this.direction0Active=!this.direction0Active},saveToFavorite:function(e){this.allDirectionsOfTheChosenRoute.forEach((function(t){t.savedInFavorite=e})),this.$emit("renewFavoriteRoutes",e,this.stopsOfTheRoute.RouteUID)},backToHomeOrFavorite:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"home";"favorite"===e?this.$router.replace({query:{routes:"favorite"}}):this.$router.replace({path:"/"}),this.$emit("changeRoutesToAll")}},mounted:function(){var e=this,t=document.getElementById("timeBar").clientWidth,r=t;this.updateDataInterval=setInterval((function(){document.getElementById("timeBar").style.width=t+"px",r=t+t/30,e.$emit("renewStopsOfRoute",{cityOfRoute:e.stopsOfTheRoute.City,routeName:e.stopsOfTheRoute.RouteName.Zh_tw,RouteUID:e.stopsOfTheRoute.RouteUID,DepartureStopNameZh:e.stopsOfTheRoute.DepartureStopNameZh,DestinationStopNameZh:e.stopsOfTheRoute.DestinationStopNameZh,CityName:e.stopsOfTheRoute.CityName,savedInFavorite:e.stopsOfTheRoute.savedInFavorite}),console.log("=========== NEW DATA +++++++++++++++ ")}),1e4),this.timeBarInterval=setInterval((function(){r-=t/10,document.getElementById("timeBar").style.width=r+"px"}),1e3)},beforeUnmount:function(){clearInterval(this.updateDataInterval),clearInterval(this.timeBarInterval),console.log("=========== NO DATA +++++++++++++++")},unmounted:function(){this.$emit("renewPopMarker",void 0),this.$emit("resetNowDirection")}};const De=y()(ke,[["render",Ce]]);var Te=De,Ie=["id"];function Ee(e,t,r,n,a,i){return Object(o["r"])(),Object(o["e"])("div",{id:r.mapId},null,8,Ie)}r("d81d");var Fe=r("e11e"),Pe=r.n(Fe),Be={name:"Map",props:["mapId","mapCenter","stops","routeGEOJSON","popMarker"],data:function(){return{map:{},markers:{},layer:Pe.a.layerGroup(this.markers),layerPostalcodes:{},geolayerGroup:{}}},watch:{popMarker:function(e){void 0!==e&&this.markers[e]&&this.markers[e].openPopup()},routeGEOJSON:function(){this.showRouteOnMap(this.routeGEOJSON)},stops:function(){var e=this;this.layer.remove();var t=[];this.stops.forEach((function(r){var o="將進站"===r.EstimateTime||"進站中"===r.EstimateTime?"bg-color-secondary":"number"===typeof r.EstimateTime?"bg-color-primary":"bg-color-grey550",n=e.newMarker(r.StopSequence,r.StopPosition.PositionLat,r.StopPosition.PositionLon,o);n.bindPopup("".concat(r.StopName.Zh_tw,"<br><b>").concat(r.EstimateTime,"</b>"),{closeButton:!1,className:o}),t.push(n)})),this.markers=t,this.layer=Pe.a.layerGroup(this.markers),this.layer.addTo(this.map)},mapCenter:{handler:function(){this.map.panTo([this.mapCenter.Lat,this.mapCenter.Lon])},deep:!0}},methods:{initalLeafletMap:function(e,t,r){this.map=Pe.a.map(e,{center:[t,r],zoom:15}),Pe.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:25,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoibG9ic3RlcjAxIiwiYSI6ImNrdXdvN3prYTUyYXgyb3BoaThwcmcxN2cifQ.CsAL1uSEtZjpGwuEpYA-6A"}).addTo(this.map)},newMarker:function(e,t,r,o){var n=Pe.a.divIcon({html:'<div class="locationIcon '.concat(o,'"><span>').concat(e,"</span></div>"),iconSize:[20,20],iconAnchor:[0,0],popupAnchor:[10,0]});return Pe.a.marker([t,r],{icon:n,clickable:!0})},showRouteOnMap:function(e){this.map.removeLayer(this.geolayerGroup),this.layerPostalcodes=new Pe.a.GeoJSON(e,{style:{color:"#355F8B",weight:5}}),this.geolayerGroup=new Pe.a.LayerGroup,this.geolayerGroup.addTo(this.map),this.geolayerGroup.addLayer(this.layerPostalcodes)}},mounted:function(){this.initalLeafletMap(this.mapId,this.mapCenter.Lat,this.mapCenter.Lon)}};const Ae=y()(Be,[["render",Ee]]);var Me=Ae,Ze={data:function(){return{allRoutesOfTaiwan:[],allRoutesOfFavorite:[],currentRoutes:[],currentRoutesFilterByKeywords:[],allDirectionsOfTheChosenRoute:[],indexOfChosenDirection:0,chosenDirectionOfChosenRoute:[],stopsOfChosenDirection:[],mapCenter:{Lat:"22.997572",Lon:"120.196029"},routeName:"",cities:[],routeGEOJSON:{},originalClientY:0,nowClientY:0,windowHeight:0,originalBoardHeight:0,newBoardHeight:0,touchingInfoPanelOrNot:"",signOfEmptyFavoriteRoute:"",nowPage:"home",popMarker:void 0}},components:{RouteSearchPanel:ce,Map:Me,StopsListPanel:Te},mixins:[H],watch:{"$route.query":{handler:function(e){"favorite"!==e.routes&&0!==Object.keys(e).length||this.showFavoriteRoutesOrAllRoutesOfTaiwan(),this.nowPage="favorite"===e.routes?"favorite":0===Object.keys(e).length?"home":this.nowPage},deep:!0},routeName:function(){""===this.routeName&&"favorite"!==this.$route.query.routes?this.currentRoutesFilterByKeywords=[]:this.filterRouteByKeywords(this.routeName)}},methods:{renewPopMarker:function(e){void 0!==e&&this.stopsOfChosenDirection[e]&&(this.mapCenter.Lat=this.stopsOfChosenDirection[e].StopPosition.PositionLat,this.mapCenter.Lon=this.stopsOfChosenDirection[e].StopPosition.PositionLon),this.popMarker=e},renewFavoriteRoutes:function(e,t){var r=this.currentRoutes.find((function(e){return e.RouteUID===t}));r.savedInFavorite=e},focusInput:function(e){document.getElementById(e).focus()},setOriginalClientY:function(e){this.originalClientY=e.touches?e.touches[0].clientY:e.clientY,this.touchingInfoPanelOrNot=!0},changeTargetHeight:function(e){this.touchingInfoPanelOrNot&&(this.nowClientY=e.changedTouches?e.changedTouches[0].clientY:e.clientY,this.originalBoardHeight=document.getElementById("infoPanel").offsetHeight,this.newBoardHeight=this.originalBoardHeight+(this.originalClientY-this.nowClientY),document.getElementById("infoPanel").style.height=this.newBoardHeight>=this.windowHeight?this.windowHeight+"px":this.newBoardHeight<=200?"200px":this.newBoardHeight+"px",this.originalClientY=this.nowClientY)},changeDirectionForMap:function(e){this.indexOfChosenDirection=e,this.chosenDirectionOfChosenRoute=this.allDirectionsOfTheChosenRoute[e],this.stopsOfChosenDirection=this.chosenDirectionOfChosenRoute.Stops},filterRouteByKeywords:function(e){this.currentRoutesFilterByKeywords=[];var t=this,r=new RegExp(e);this.currentRoutes.forEach((function(e){r.test(e.RouteName.Zh_tw+"*")&&t.currentRoutesFilterByKeywords.push(e)}))},showFavoriteRoutesOrAllRoutesOfTaiwan:function(){this.deselectChosenRoute(),this.saveFavoriteRoutesFromLocalStorage(),"favorite"===this.$route.query.routes?this.setCurrentRoutesWith({routes:this.allRoutesOfFavorite,routesFilterByKeywords:this.allRoutesOfFavorite}):this.setCurrentRoutesWith({routes:this.allRoutesOfTaiwan})},deselectChosenRoute:function(){this.routeName="",this.chosenDirectionOfChosenRoute=[],this.stopsOfChosenDirection=[],this.routeGEOJSON=""},saveFavoriteRoutesFromLocalStorage:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=localStorage.getItem("favoriteRouteList"),e.allRoutesOfFavorite=r?JSON.parse(r):[],e.allRoutesOfFavorite.forEach((function(t){var r=e.allRoutesOfTaiwan.filter((function(e){return e.RouteUID===t.RouteUID}));r[0]&&(r[0].savedInFavorite=!0)}));case 3:case"end":return t.stop()}}),t)})))()},setCurrentRoutesWith:function(e){var t=e.routes,r=void 0===t?this.allRoutesOfTaiwan:t,o=e.routesFilterByKeywords,n=void 0===o?[]:o;this.currentRoutes=r,this.currentRoutesFilterByKeywords=n,this.signOfEmptyFavoriteRoute=0===r.length?"還沒有收藏的站牌YO":""},getStopsOfRoute:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o,n,a,i,c,s,u,l,p,h,f,d,b,m,O;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=e.cityOfRoute,n=void 0===o?t.$route.query.cityOfRoute:o,a=e.routeName,i=void 0===a?t.$route.query.routeName:a,c=e.RouteUID,s=void 0===c?t.$route.query.RouteUID:c,u=e.DepartureStopNameZh,l=void 0===u?t.$route.query.DepartureStopNameZh:u,p=e.DestinationStopNameZh,h=void 0===p?t.$route.query.DestinationStopNameZh:p,f=e.CityName,d=void 0===f?t.$route.query.CityName:f,b=e.savedInFavorite,t.$router.replace({query:{cityOfRoute:n,routeName:i,RouteUID:s,DepartureStopNameZh:l,DestinationStopNameZh:h,CityName:d}}),t.routeName=i,m=t,r.t0=m,r.next=7,t.getVehicleOfTaiwan(t.cities);case 7:return r.t1=r.sent,r.t2=n,r.t3=i,r.t4=s,r.next=13,r.t0.sortRealTimeNearStopAndEstimatedTimeByStopsOfTheRoute.call(r.t0,r.t1,r.t2,r.t3,r.t4);case 13:return t.allDirectionsOfTheChosenRoute=r.sent,r.next=16,m.allDirectionsOfTheChosenRoute.forEach((function(e){e.DepartureStopNameZh=l,e.DestinationStopNameZh=h,e.CityName=d,e.savedInFavorite=b}));case 16:return r.next=18,m.allDirectionsOfTheChosenRoute[m.indexOfChosenDirection];case 18:return m.chosenDirectionOfChosenRoute=r.sent,r.next=21,t.getRouteGEOJSON(n,i);case 21:t.routeGEOJSON=r.sent,m.stopsOfChosenDirection=m.chosenDirectionOfChosenRoute.Stops,O=void 0===t.popMarker?parseInt(m.stopsOfChosenDirection.length/2):t.popMarker,m.mapCenter.Lat=m.stopsOfChosenDirection[O].StopPosition.PositionLat,m.mapCenter.Lon=m.stopsOfChosenDirection[O].StopPosition.PositionLon;case 26:case"end":return r.stop()}}),r)})))()},showStopsOfSpecificRouteOrNot:function(){return this.$route.query.cityOfRoute&&this.$route.query.routeName&&this.$route.query.RouteUID&&this.$route.query.DepartureStopNameZh&&this.$route.query.DestinationStopNameZh&&this.$route.query.CityName}},mounted:function(){this.windowHeight=document.getElementById("infoPanel").offsetHeight/.9},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getCityList();case 2:return e.cities=t.sent,t.next=5,e.getRoutesOfTaiwan(e.cities);case 5:e.allRoutesOfTaiwan=t.sent,e.showFavoriteRoutesOrAllRoutesOfTaiwan(),e.showStopsOfSpecificRouteOrNot()&&e.getStopsOfRoute({});case 8:case"end":return t.stop()}}),t)})))()}};const Ue=y()(Ze,[["render",A]]);var Le=Ue,$e=[{path:"/",name:"Home",component:Le}],_e=Object(x["a"])({history:Object(x["b"])("/taiwan_bus/"),routes:$e}),He=_e;Object(o["c"])(R).use(He).mount("#app")},"6c49":function(e,t,r){},a374:function(e,t,r){"use strict";r("6c49")}});
//# sourceMappingURL=app.906e9825.js.map